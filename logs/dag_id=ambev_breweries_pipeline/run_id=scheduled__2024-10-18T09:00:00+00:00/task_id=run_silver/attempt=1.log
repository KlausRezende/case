[2024-10-19T14:24:16.607+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: ambev_breweries_pipeline.run_silver scheduled__2024-10-18T09:00:00+00:00 [queued]>
[2024-10-19T14:24:16.613+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: ambev_breweries_pipeline.run_silver scheduled__2024-10-18T09:00:00+00:00 [queued]>
[2024-10-19T14:24:16.614+0000] {taskinstance.py:1279} INFO - 
--------------------------------------------------------------------------------
[2024-10-19T14:24:16.614+0000] {taskinstance.py:1280} INFO - Starting attempt 1 of 1
[2024-10-19T14:24:16.614+0000] {taskinstance.py:1281} INFO - 
--------------------------------------------------------------------------------
[2024-10-19T14:24:16.623+0000] {taskinstance.py:1300} INFO - Executing <Task(BashOperator): run_silver> on 2024-10-18 09:00:00+00:00
[2024-10-19T14:24:16.626+0000] {standard_task_runner.py:55} INFO - Started process 212 to run task
[2024-10-19T14:24:16.627+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'ambev_breweries_pipeline', 'run_silver', 'scheduled__2024-10-18T09:00:00+00:00', '--job-id', '25', '--raw', '--subdir', 'DAGS_FOLDER/dag_brewery.py', '--cfg-path', '/tmp/tmpyi426f5q']
[2024-10-19T14:24:16.628+0000] {standard_task_runner.py:83} INFO - Job 25: Subtask run_silver
[2024-10-19T14:24:16.638+0000] {logging_mixin.py:137} WARNING - /usr/local/lib/python3.9/site-packages/***/settings.py:249 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2024-10-19T14:24:16.651+0000] {logging_mixin.py:137} WARNING - /usr/local/lib/python3.9/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2024-10-19T14:24:16.672+0000] {task_command.py:388} INFO - Running <TaskInstance: ambev_breweries_pipeline.run_silver scheduled__2024-10-18T09:00:00+00:00 [running]> on host 39b0b1bd9d5a
[2024-10-19T14:24:16.717+0000] {taskinstance.py:1507} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Klaus_Rezende
AIRFLOW_CTX_DAG_ID=ambev_breweries_pipeline
AIRFLOW_CTX_TASK_ID=run_silver
AIRFLOW_CTX_EXECUTION_DATE=2024-10-18T09:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2024-10-18T09:00:00+00:00
[2024-10-19T14:24:16.717+0000] {subprocess.py:63} INFO - Tmp dir root location: 
 /tmp
[2024-10-19T14:24:16.718+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python3 /opt/***/scripts/silver_brewery.py']
[2024-10-19T14:24:16.724+0000] {subprocess.py:86} INFO - Output:
[2024-10-19T14:24:18.637+0000] {subprocess.py:93} INFO - Setting default log level to "WARN".
[2024-10-19T14:24:18.637+0000] {subprocess.py:93} INFO - To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[2024-10-19T14:24:18.789+0000] {subprocess.py:93} INFO - 24/10/19 14:24:18 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2024-10-19T14:24:22.539+0000] {subprocess.py:93} INFO - Dataframe has data, processing...
[2024-10-19T14:24:22.539+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2024-10-19T14:24:22.540+0000] {subprocess.py:93} INFO -   File "/opt/***/scripts/silver_brewery.py", line 72, in <module>
[2024-10-19T14:24:22.541+0000] {subprocess.py:93} INFO -     df_silver.write \
[2024-10-19T14:24:22.541+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 1463, in save
[2024-10-19T14:24:22.542+0000] {subprocess.py:93} INFO -     self._jwrite.save(path)
[2024-10-19T14:24:22.542+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.9/site-packages/py4j/java_gateway.py", line 1322, in __call__
[2024-10-19T14:24:22.542+0000] {subprocess.py:93} INFO -     return_value = get_return_value(
[2024-10-19T14:24:22.543+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.9/site-packages/pyspark/errors/exceptions/captured.py", line 185, in deco
[2024-10-19T14:24:22.543+0000] {subprocess.py:93} INFO -     raise converted from None
[2024-10-19T14:24:22.546+0000] {subprocess.py:93} INFO - pyspark.errors.exceptions.captured.AnalysisException: Partition column `name_state` not found in schema struct<id_brewery:string,name_brewery:string,type_brewery:string,phone_brewery:string,country_brewery:string,state_brewery:string,state_province_brewery:string,city_brewery:string,postal_code_brewery:string,latitude_brewery:string,longitude_brewery:string,address_1_brewery:string,address_2_brewery:string,address_3_brewery:string,updated_at:string>.
[2024-10-19T14:24:22.975+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2024-10-19T14:24:22.984+0000] {taskinstance.py:1768} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/airflow/operators/bash.py", line 196, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-10-19T14:24:22.987+0000] {taskinstance.py:1318} INFO - Marking task as FAILED. dag_id=ambev_breweries_pipeline, task_id=run_silver, execution_date=20241018T090000, start_date=20241019T142416, end_date=20241019T142422
[2024-10-19T14:24:22.996+0000] {standard_task_runner.py:100} ERROR - Failed to execute job 25 for task run_silver (Bash command failed. The command returned a non-zero exit code 1.; 212)
[2024-10-19T14:24:23.012+0000] {local_task_job.py:208} INFO - Task exited with return code 1
[2024-10-19T14:24:23.028+0000] {taskinstance.py:2578} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-10-20T00:50:59.015+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: ambev_breweries_pipeline.run_silver scheduled__2024-10-18T09:00:00+00:00 [queued]>
[2024-10-20T00:50:59.027+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: ambev_breweries_pipeline.run_silver scheduled__2024-10-18T09:00:00+00:00 [queued]>
[2024-10-20T00:50:59.028+0000] {taskinstance.py:1279} INFO - 
--------------------------------------------------------------------------------
[2024-10-20T00:50:59.029+0000] {taskinstance.py:1280} INFO - Starting attempt 1 of 1
[2024-10-20T00:50:59.030+0000] {taskinstance.py:1281} INFO - 
--------------------------------------------------------------------------------
[2024-10-20T00:50:59.047+0000] {taskinstance.py:1300} INFO - Executing <Task(BashOperator): run_silver> on 2024-10-18 09:00:00+00:00
[2024-10-20T00:50:59.051+0000] {standard_task_runner.py:55} INFO - Started process 202 to run task
[2024-10-20T00:50:59.054+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'ambev_breweries_pipeline', 'run_silver', 'scheduled__2024-10-18T09:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/dag_brewery.py', '--cfg-path', '/tmp/tmpjw_gyca3']
[2024-10-20T00:50:59.058+0000] {standard_task_runner.py:83} INFO - Job 3: Subtask run_silver
[2024-10-20T00:50:59.099+0000] {logging_mixin.py:137} WARNING - /usr/local/lib/python3.9/site-packages/***/settings.py:249 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2024-10-20T00:50:59.126+0000] {logging_mixin.py:137} WARNING - /usr/local/lib/python3.9/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2024-10-20T00:50:59.173+0000] {task_command.py:388} INFO - Running <TaskInstance: ambev_breweries_pipeline.run_silver scheduled__2024-10-18T09:00:00+00:00 [running]> on host 96311538d4eb
[2024-10-20T00:50:59.263+0000] {taskinstance.py:1507} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Klaus_Rezende
AIRFLOW_CTX_DAG_ID=ambev_breweries_pipeline
AIRFLOW_CTX_TASK_ID=run_silver
AIRFLOW_CTX_EXECUTION_DATE=2024-10-18T09:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2024-10-18T09:00:00+00:00
[2024-10-20T00:50:59.264+0000] {subprocess.py:63} INFO - Tmp dir root location: 
 /tmp
[2024-10-20T00:50:59.266+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python3 /opt/***/scripts/silver_brewery.py']
[2024-10-20T00:50:59.273+0000] {subprocess.py:86} INFO - Output:
[2024-10-20T00:51:05.253+0000] {subprocess.py:93} INFO - Setting default log level to "WARN".
[2024-10-20T00:51:05.253+0000] {subprocess.py:93} INFO - To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[2024-10-20T00:51:05.592+0000] {subprocess.py:93} INFO - 24/10/20 00:51:05 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2024-10-20T00:51:31.368+0000] {subprocess.py:93} INFO - [Stage 4:>                                                          (0 + 1) / 1]                                                                                Dataframe has data, processing...
[2024-10-20T00:51:31.919+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2024-10-20T00:51:31.977+0000] {taskinstance.py:1318} INFO - Marking task as SUCCESS. dag_id=ambev_breweries_pipeline, task_id=run_silver, execution_date=20241018T090000, start_date=20241020T005059, end_date=20241020T005131
[2024-10-20T00:51:32.002+0000] {local_task_job.py:208} INFO - Task exited with return code 0
[2024-10-20T00:51:32.044+0000] {taskinstance.py:2578} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-10-20T02:54:34.035+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: ambev_breweries_pipeline.run_silver scheduled__2024-10-18T09:00:00+00:00 [queued]>
[2024-10-20T02:54:34.048+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: ambev_breweries_pipeline.run_silver scheduled__2024-10-18T09:00:00+00:00 [queued]>
[2024-10-20T02:54:34.049+0000] {taskinstance.py:1279} INFO - 
--------------------------------------------------------------------------------
[2024-10-20T02:54:34.049+0000] {taskinstance.py:1280} INFO - Starting attempt 1 of 1
[2024-10-20T02:54:34.050+0000] {taskinstance.py:1281} INFO - 
--------------------------------------------------------------------------------
[2024-10-20T02:54:34.065+0000] {taskinstance.py:1300} INFO - Executing <Task(BashOperator): run_silver> on 2024-10-18 09:00:00+00:00
[2024-10-20T02:54:34.069+0000] {standard_task_runner.py:55} INFO - Started process 6446 to run task
[2024-10-20T02:54:34.071+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'ambev_breweries_pipeline', 'run_silver', 'scheduled__2024-10-18T09:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/dag_brewery.py', '--cfg-path', '/tmp/tmpma9x89t7']
[2024-10-20T02:54:34.073+0000] {standard_task_runner.py:83} INFO - Job 3: Subtask run_silver
[2024-10-20T02:54:34.098+0000] {logging_mixin.py:137} WARNING - /usr/local/lib/python3.9/site-packages/***/settings.py:249 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2024-10-20T02:54:34.125+0000] {logging_mixin.py:137} WARNING - /usr/local/lib/python3.9/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2024-10-20T02:54:34.177+0000] {task_command.py:388} INFO - Running <TaskInstance: ambev_breweries_pipeline.run_silver scheduled__2024-10-18T09:00:00+00:00 [running]> on host 939493bb965b
[2024-10-20T02:54:34.332+0000] {taskinstance.py:1507} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Klaus_Rezende
AIRFLOW_CTX_DAG_ID=ambev_breweries_pipeline
AIRFLOW_CTX_TASK_ID=run_silver
AIRFLOW_CTX_EXECUTION_DATE=2024-10-18T09:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2024-10-18T09:00:00+00:00
[2024-10-20T02:54:34.338+0000] {subprocess.py:63} INFO - Tmp dir root location: 
 /tmp
[2024-10-20T02:54:34.341+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python3 /opt/***/scripts/silver_brewery.py']
[2024-10-20T02:54:34.362+0000] {subprocess.py:86} INFO - Output:
[2024-10-20T02:54:38.372+0000] {subprocess.py:93} INFO - Setting default log level to "WARN".
[2024-10-20T02:54:38.373+0000] {subprocess.py:93} INFO - To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[2024-10-20T02:54:38.671+0000] {subprocess.py:93} INFO - 24/10/20 02:54:38 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2024-10-20T02:54:54.508+0000] {subprocess.py:93} INFO - [Stage 4:>                                                          (0 + 1) / 1]                                                                                Dataframe has data, processing...
[2024-10-20T02:54:55.051+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2024-10-20T02:54:55.087+0000] {taskinstance.py:1318} INFO - Marking task as SUCCESS. dag_id=ambev_breweries_pipeline, task_id=run_silver, execution_date=20241018T090000, start_date=20241020T025434, end_date=20241020T025455
[2024-10-20T02:54:55.113+0000] {local_task_job.py:208} INFO - Task exited with return code 0
[2024-10-20T02:54:55.157+0000] {taskinstance.py:2578} INFO - 1 downstream tasks scheduled from follow-on schedule check
